# Hacker News Daily — 网站性能报告

**报告日期：** 2026-02-22  
**测试环境：** Chromium (Linux sandbox) → GitHub Pages CDN  
**网站地址：** https://chaowang15.github.io/hackernews/

---

## 一、总体评估

Hacker News Daily 是一个纯静态网站，托管在 GitHub Pages 上，采用 Jekyll 构建。整体架构非常轻量：**零外部 JS 依赖**，仅加载一个 CSS 和一个 JS 文件，所有交互逻辑均为原生 JavaScript 实现。GitHub Pages 自动启用 gzip 压缩和 CDN 分发，为全球用户提供了良好的基础性能。

> **综合评级：A（优秀）** — 所有页面加载时间均在 1 秒以内，无 JS 错误，无 console 警告，资源请求数极少。

---

## 二、页面加载性能

以下数据基于浏览器 Navigation Timing API 采集，反映从请求发起到页面完全加载的各阶段耗时。

| 页面 | TTFB | DOM Interactive | DOM Complete | Load Event | 评级 |
|------|------|-----------------|--------------|------------|------|
| **Index** | 47ms | 828ms | 831ms | 832ms | A |
| **Trending (100 stories)** | 56ms | 302ms | 332ms | 332ms | A+ |
| **Weekly Digest (273 stories)** | 68ms | 571ms | 577ms | 577ms | A |
| **Trends (Stream Graph)** | 52ms | 122ms | 124ms | 124ms | A+ |
| **404 Page** | 44ms | 70ms | 84ms | 84ms | A+ |

**关键发现：**

所有页面的 TTFB（首字节时间）均在 44–68ms 范围内，说明 GitHub Pages CDN 响应极快。DOM Complete 时间最长的是 Index 页面（831ms），这是因为 Index 页面在首次加载时需要下载 CSS 和 JS 文件（后续页面从缓存读取）。Trending 和 Weekly Digest 虽然内容量大（100–273 条新闻），但由于 CSS/JS 已缓存，加载时间反而更短。

---

## 三、资源传输分析

GitHub Pages 自动对所有文本资源启用 gzip 压缩。以下表格对比了各资源的原始大小与实际传输大小。

### 3.1 静态资源

| 资源 | 原始大小 | Gzip 传输 | 压缩率 | 说明 |
|------|----------|-----------|--------|------|
| `hn.css` | 44.2 KB | 9.2 KB | 79% | 唯一的 CSS 文件，2102 行 |
| `hn.js` | 59.3 KB | 15.4 KB | 74% | 唯一的 JS 文件，1660 行 |
| `search_index.json` | 116 KB | 36.4 KB | 69% | 搜索索引，288 条记录 |
| `feed.xml` | 71.4 KB | 21.9 KB | 69% | RSS Feed，Top 50 故事 |
| `tag_cloud.json` | 0.8 KB | 0.6 KB | 25% | 气泡图数据 |
| `tag_trend.json` | 1.5 KB | 0.8 KB | 47% | Stream Graph 数据 |

### 3.2 HTML 页面

| 页面 | 原始大小 | Gzip 传输 | 压缩率 |
|------|----------|-----------|--------|
| Index | 15.6 KB | 3.1 KB | 80% |
| Trending (100 stories) | 168.2 KB | 44.2 KB | 74% |
| Daily Best (50 stories) | 83.4 KB | 22.3 KB | 73% |
| Weekly Digest (273 stories) | 279.3 KB | 42.8 KB | 85% |
| Trends | 1.2 KB | 0.6 KB | 50% |

### 3.3 JSON 数据文件

| 文件 | 大小 | 说明 |
|------|------|------|
| Trending JSON (per day) | 56–117 KB | 包含完整故事数据 + 摘要 |
| Daily Best JSON (per day) | 24–67 KB | 包含完整故事数据 + 摘要 |
| Weekly Digest JSON | 348 KB | 一周所有故事汇总 |
| **JSON 数据总量** | **1.1 MB** | 6 天数据 |

---

## 四、资源请求数

| 页面 | HTML | CSS | JS | JSON | 图片 | 总计 |
|------|------|-----|-----|------|------|------|
| Index | 1 | 1 | 1 | 0 | 0 | **3** |
| Trending | 1 | 1 | 1 | 0 | ~6 (lazy) | **~9** |
| Weekly Digest | 1 | 1 | 1 | 0 | 0 | **3** |
| Trends | 1 | 1 | 1 | 2 | 0 | **5** |
| 404 | 1 | 0 | 0 | 0 | 0 | **1** |

所有页面的资源请求数均极少（1–9 个），远低于现代网站的平均水平（50–100+ 个请求）。这得益于零外部依赖的架构设计。

---

## 五、错误率与健康状态

| 检查项 | 状态 | 详情 |
|--------|------|------|
| **JavaScript 错误** | 0 | 所有页面 console 无错误输出 |
| **Console 警告** | 0 | 无任何警告信息 |
| **图片懒加载** | 已实现 | Trending 页面 84 张图片均使用 `loading='lazy'` |
| **图片错误处理** | 未实现 | 未检测到 `onerror` 处理器（依赖 CSS 占位） |
| **外部图片依赖** | 81 张/天 | Trending 页面引用 81 个外部图片 URL |
| **HTTP 缓存** | `max-age=600` | GitHub Pages 默认 10 分钟缓存 |
| **Gzip 压缩** | 已启用 | 所有文本资源自动 gzip |
| **HTTPS** | 已启用 | GitHub Pages 强制 HTTPS |
| **外部 JS 库** | 0 | 无 D3.js、jQuery 等外部依赖 |

---

## 六、架构亮点

本网站在性能方面有以下值得称道的设计：

**零外部依赖。** 整个网站仅加载两个自有文件（hn.css + hn.js），不依赖任何 CDN 库（如 D3.js、jQuery、Bootstrap）。Stream Graph 和气泡图均通过原生 Canvas/SVG 实现，避免了大型可视化库的开销。

**纯静态生成。** 所有页面在构建时由 Python 脚本预渲染为 HTML，浏览器端无需执行 API 调用或动态渲染。唯一的异步请求是 Trends 页面加载两个小型 JSON 文件（合计 1.4 KB）。

**图片懒加载。** Trending 和 Daily Best 页面的故事卡片图片使用原生 `loading='lazy'` 属性，避免首屏加载时下载所有图片。

**搜索索引本地化。** 搜索功能基于本地 JSON 索引（36 KB gzip），无需服务端搜索 API，实现了即时搜索体验。

**CSS/JS 版本控制。** 通过 URL 查询参数（`?v=20260222a`）实现缓存失效控制，确保更新后用户能获取最新资源。

---

## 七、潜在问题与风险

### 7.1 Weekly Digest 页面体积偏大

Weekly Digest 页面原始 HTML 为 279 KB（gzip 后 43 KB），包含 273 条故事。随着数据积累，如果未来一周故事数量增长，页面体积可能进一步膨胀。目前尚在可接受范围内，但值得监控。

### 7.2 外部图片依赖

Trending 页面引用了 81 个外部图片 URL（来自各新闻源站点）。这些图片的可用性完全取决于第三方服务器，可能出现：
- 图片 404（源站删除）
- 加载缓慢（源站性能差）
- CORS 限制

目前通过 CSS 占位和懒加载缓解了影响，但没有 `onerror` 回退处理。

### 7.3 搜索索引增长

当前搜索索引包含 288 条记录（116 KB 原始 / 36 KB gzip）。随着每天新增 ~100 条故事，索引将线性增长。预计一个月后索引将达到约 3000 条记录（~1.2 MB 原始 / ~370 KB gzip），可能影响首次搜索体验。

### 7.4 GitHub Pages 缓存限制

GitHub Pages 的 `Cache-Control: max-age=600`（10 分钟）是平台强制设置，无法自定义。这意味着：
- 新内容发布后，用户最多需等待 10 分钟才能看到更新
- 无法设置更长的缓存时间来优化静态资源的重复访问

### 7.5 CSS/JS 未压缩

CSS（44 KB）和 JS（59 KB）文件均为未压缩的开发格式。简单的空白压缩可分别减少约 14% 和 18% 的体积。虽然 gzip 已经大幅压缩了传输大小，但压缩源文件仍可进一步减少约 1–2 KB 的传输量。

---

## 八、性能对比基准

将本网站与同类静态新闻聚合站点进行对比：

| 指标 | Hacker News Daily | 行业平均 (静态站) | 评价 |
|------|-------------------|-------------------|------|
| 首次加载资源数 | 3 | 15–30 | 远优于平均 |
| 首次加载传输量 | ~28 KB | 200–500 KB | 远优于平均 |
| TTFB | 44–68ms | 100–300ms | 优于平均 |
| DOM Complete | 84–832ms | 1–3s | 优于平均 |
| 外部 JS 依赖 | 0 | 3–10 | 远优于平均 |
| Console 错误 | 0 | 1–5 | 优于平均 |

---

## 九、优化建议

以下建议按优先级排列，标注了预期收益和实施复杂度。

| 优先级 | 建议 | 预期收益 | 复杂度 |
|--------|------|----------|--------|
| **低** | CSS/JS 压缩（去除空白和注释） | 传输减少 ~2 KB | 低 |
| **低** | 为外部图片添加 `onerror` 回退 | 避免破图显示 | 低 |
| **中** | 搜索索引分片（按周/月拆分） | 避免索引无限增长 | 中 |
| **中** | 添加 Service Worker 离线缓存 | 支持离线阅读 | 中 |
| **低** | 预连接外部图片域名 (`dns-prefetch`) | 图片加载提速 ~50ms | 低 |

需要注意的是，由于网站当前性能已经非常优秀（所有页面 < 1 秒加载），上述优化的边际收益较小。建议仅在出现实际性能问题时再考虑实施。

---

## 十、总结

Hacker News Daily 网站的整体性能表现**优秀**。零外部依赖、纯静态生成、极少的资源请求数使其在加载速度方面远超同类网站。所有页面均无 JavaScript 错误和 console 警告，健康状态良好。

主要关注点是搜索索引的长期增长和外部图片的可靠性，但这些在当前数据规模下尚不构成问题。整体而言，网站架构设计合理，性能优化空间有限，说明现有实现已经接近最优状态。
